{"version":3,"file":"authentication-b68d6f4a.js","sources":["../../../../../src/components/special/authenticationForm.vue","../../../../../src/pages/authentication.vue"],"sourcesContent":["<script setup>\r\n\timport { ref } from 'vue'\r\n\timport { routerKey, useRouter } from 'vue-router'\r\n\timport { useAuthenticationTypeStore, useLoginStore } from '@/stores/login'\r\n\tconst authStore = useAuthenticationTypeStore()\r\n\tconst loginStore = useLoginStore()\r\n\tconst {setEmail,setToken} = loginStore\r\n\r\n\tconst props = defineProps({\r\n\t\tbuttonText: String\r\n\t})\r\n\tconst emit = defineEmits(['functionEmit'])\r\n\tconst email = ref()\r\n\tconst password = ref()\r\n\tfunction triggerEmit(){\r\n\t\temit('functionEmit',email.value,password.value)\r\n\t}\r\n</script>\r\n\r\n<template>\r\n\t<v-form>\r\n\t\t<v-text-field\r\n\t\t\tname=\"email\"\r\n\t\t\ttype=\"email\"\r\n\t\t\tplaceholder=\"email\"\r\n\t\t\tv-model=\"email\"\r\n\t\t\tcols=\"20\"\r\n\t\t/>\r\n\t\t<v-text-field\r\n\t\t\ttype=\"password\"\r\n\t\t\tplaceholder=\"password\"\r\n\t\t\tv-model=\"password\"\r\n\t\t\tcols=\"20\"\r\n\t\t/>\r\n\t\t<v-btn\r\n\t\t\ttype=\"button\"\r\n\t\t\t@click=\"()=>{\r\n\t\t\t\ttriggerEmit()\r\n\t\t\t}\"\r\n\t\t>\r\n\t\t\t{{ buttonText }}\r\n\t\t</v-btn>\r\n\t</v-form>\r\n</template>","<script setup>\r\nimport {useRouter} from 'vue-router'\r\nimport { ref } from \"vue\";\r\nimport { useLoginStore, useAuthenticationTypeStore } from '@/stores/login'\r\n\r\nconst router = useRouter()\r\nconst loginStore = useLoginStore()\r\nconst authStore = useAuthenticationTypeStore()\r\nconst {setEmail,setToken,setLoginState} = loginStore\r\nconst error = ref()\r\nconst message = ref()\r\nasync function login(email,password){\r\n\tconst {data} = await useFetch('/api/login',{\r\n\t\tmethod:'POST',\r\n\t\tbody:{\r\n\t\t\temail:email,\r\n\t\t\tpassword:password\r\n\t\t}\r\n\t})\r\n\terror.value = data.value.errorMessage\r\n\tmessage.value = data.value.message\r\n\tif(message.value){\r\n\t\tconsole.log('before setToken',loginStore.token,'the token value is', data.value.token)\r\n\t\tsetToken(data.value.token)\r\n\t\tconsole.log('after set token',loginStore.token)\r\n\t\tsetEmail(data.value.email)\r\n\t\tsetLoginState(true)\r\n\t\trouter.push('/personal')\r\n\t} else {\r\n\t\tsetEmail(null)\r\n\t}\r\n}\r\nasync function register(email,password){\r\n\tconsole.log(email)\r\n\tconsole.log(password)\r\n\tconst {data} = await useFetch('/api/register',{\r\n\t\tmethod:'POST',\r\n\t\tbody:{\r\n\t\t\temail:email,\r\n\t\t\tpassword:password\r\n\t\t}\r\n\t})\r\n\terror.value = data.value.errorMessage\r\n\tmessage.value = data.value.Emit\r\n\tif(message.value){\r\n\t\tsetToken(data.value.token)\r\n\t\tsetEmail(data.value.email)\r\n\t}\r\n}\r\n\r\n</script>\r\n\r\n<template>\r\n  <div id=\"login-register\">\r\n\t\t<div\r\n\t\t\tid=\"login-form\"\r\n\t\t\tv-if=\"authStore.isLoginForm\"\r\n\t\t>\r\n\t\t\t<AuthenticationForm\r\n\t\t\t\tbuttonText=\"login\"\r\n\t\t\t\t@functionEmit=\"(emailEmitArg, passEmitArg)=>{\r\n\t\t\t\t\tlogin(emailEmitArg,passEmitArg)\r\n\t\t\t\t}\"\r\n\t\t\t/>\r\n\t\t\t<v-divider vertical/>\r\n\t\t\t<v-btn\r\n\t\t\t\t@click=\"()=>authStore.isLoginForm=false\"\r\n\t\t\t>Register</v-btn>\r\n\t\t</div>\r\n    \r\n\t\t<div\r\n\t\t\tid=\"register-form\"\r\n\t\t\tv-else\r\n\t\t>\r\n\t\t\t<v-btn\r\n\t\t\t\t@click=\"()=>authStore.isLoginForm=true\"\r\n\t\t\t>Login</v-btn>\r\n\t\t\t<v-divider vertical/>\r\n\t\t\t<AuthenticationForm\r\n\t\t\t\tbuttonText=\"register\"\r\n\t\t\t\t@functionEmit=\"(emailEmitArg,passEmitArg)=>{\r\n\t\t\t\t\tregister(emailEmitArg,passEmitArg)\r\n\t\t\t\t}\"\r\n\t\t\t/>\r\n\t\t</div>\r\n\t\t\r\n    <br>\r\n    <div\r\n      v-if=\"error\"\r\n      class=\"error\"\r\n      :text=\"error\"\r\n    />\r\n    <div\r\n      v-if=\"message\"\r\n      :text=\"error\"\r\n    />\r\n  </div>\r\n</template>\r\n\r\n<style scoped>\r\n#login-register{\r\n\tmargin-top: 4dvh;\r\n\tmargin-left: auto;\r\n\tmargin-right: auto;\r\n\twidth: 500px;\r\n\theight:200px\r\n}\r\n.error{\r\n\tcolor:crimson;\r\n}\r\n#register-button{\r\n\tmargin-left: 10px;\r\n}\r\n\r\n#login-form, #register-form{\r\n\tdisplay: flex;\r\n\tflex-direction: row;\r\n\twidth: 500px;\r\n\tjustify-content: center;\r\n\talign-items: center;\r\n}\r\n\r\nform{\r\n\twidth: 100%;\r\n\tmargin: 10px;\r\n}\r\n\r\n.v-btn{\r\n\tmargin: 10px\r\n}\r\n</style>"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;AAImB,+BAA4B;AAC3B,kBAAe;AAOlC,UAAM,QAAQ,IAAK;AACnB,UAAM,WAAW,IAAK;AACtB,aAAS,cAAa;AACrB,WAAK,gBAAe,MAAM,OAAM,SAAS,KAAK;AAAA,IAC9C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACXF,UAAA,SAAA,UAAA;AACA,UAAA,aAAA,cAAA;AACA,UAAA,YAAA,2BAAA;AACA,UAAA,EAAA,UAAA,UAAA,cAAA,IAAA;AACA,UAAA,QAAA,IAAA;AACA,UAAA,UAAA,IAAA;AACA,mBAAA,MAAA,OAAA,UAAA;AACA,YAAA,EAAA,KAAA,IAAA,MAAA,SAAA,cAAA;AAAA,QACA,QAAA;AAAA,QACA,MAAA;AAAA,UACA;AAAA,UACA;AAAA,QACA;AAAA,MACA,GAAA,aAAA;AACA,YAAA,QAAA,KAAA,MAAA;AACA,cAAA,QAAA,KAAA,MAAA;AACA,UAAA,QAAA,OAAA;AACA,gBAAA,IAAA,mBAAA,WAAA,OAAA,sBAAA,KAAA,MAAA,KAAA;AACA,iBAAA,KAAA,MAAA,KAAA;AACA,gBAAA,IAAA,mBAAA,WAAA,KAAA;AACA,iBAAA,KAAA,MAAA,KAAA;AACA,sBAAA,IAAA;AACA,eAAA,KAAA,WAAA;AAAA,MACA,OAAA;AACA,iBAAA,IAAA;AAAA,MACA;AAAA,IACA;AACA,mBAAA,SAAA,OAAA,UAAA;AACA,cAAA,IAAA,KAAA;AACA,cAAA,IAAA,QAAA;AACA,YAAA,EAAA,KAAA,IAAA,MAAA,SAAA,iBAAA;AAAA,QACA,QAAA;AAAA,QACA,MAAA;AAAA,UACA;AAAA,UACA;AAAA,QACA;AAAA,MACA,GAAA,aAAA;AACA,YAAA,QAAA,KAAA,MAAA;AACA,cAAA,QAAA,KAAA,MAAA;AACA,UAAA,QAAA,OAAA;AACA,iBAAA,KAAA,MAAA,KAAA;AACA,iBAAA,KAAA,MAAA,KAAA;AAAA,MACA;AAAA,IACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}